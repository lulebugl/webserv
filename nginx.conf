# Process management
worker_processes 1;
# # pid /tmp/nginx.pid;
# error_log /tmp/nginx_error.log;
user mweerts;
events {
    worker_connections 1024;
}

http {
    # MIME types
    # 
    include /etc/nginx/mime.types;
    default_type application/octet-stream;
    # Access log
    access_log /tmp/nginx_access.log;

    # Temporary directories (use /tmp to avoid permission issues)
    client_body_temp_path /tmp/nginx_client_temp;
    proxy_temp_path /tmp/nginx_proxy_temp;
    fastcgi_temp_path /tmp/nginx_fastcgi_temp;
    uwsgi_temp_path /tmp/nginx_uwsgi_temp;
    scgi_temp_path /tmp/nginx_scgi_temp;

    server {
        listen 8000;
        server_name localhost;
        
        # Root directory where your HTML files are
        root /home/mweerts/webserv/www;
        index index.html;
        
        # Enable autoindex for uploads directory
        location /uploads {
            autoindex on;
            autoindex_exact_size off;
            autoindex_localtime on;
            autoindex_format html;
            
            # Custom autoindex styling (optional)
            add_header Content-Type text/html;
            
            # Allow file uploads to this directory
            client_max_body_size 100M;
            alias /home/mweerts/webserv/www/test;
        }
   
        # Upload handler (simple response)
        location /upload_handler {
            return 200 "Upload successful";
            add_header Content-Type text/plain;
        }
        
        # API endpoint for file listing
        location /api/files {
            # We'll handle this with a simple script
            try_files $uri @files_api;
        }
        
    }

}

